kind: ConfigMap 
apiVersion: v1 
metadata:
  name: {{ .Release.Name }}-cm-scripts
  labels:
    app: {{ .Values.appname }}
data:
  #This script modifies the default httpd page with parameters extracted from secrets and configmaps
  index.sh: |
   #!/bin/bash
   user=$(cat /etc/usrpwd/username)
   pass=$(cat /etc/usrpwd/password)
   sleep $[ ( $RANDOM % 10 )  + 1 ]s
   #  Avoids more than three entries
   if [[ $( cat /app/index.html | grep -i generated | wc -l ) -eq 3 ]]; then
     rm /app/index.html
   fi
   cat << EOF >> /app/index.html
   <html><body><h1>KUBES&CLOUDS</h1>
   <h2>Username: ${user}</h2>
   <h2>Password: ${pass}</h2>
   <h2>Environment Variable: ${ENV_VAR}</h2>
   <h3>Generated by: $(hostname)</h3></body></html>
   EOF


  

